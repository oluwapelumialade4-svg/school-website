server.port=${PORT:8081}
server.error.include-message=always
server.error.include-stacktrace=always
server.error.whitelabel.enabled=true

# PostgreSQL Configuration (for production/cloud deployment)
spring.datasource.url=${SPRING_DATASOURCE_URL:${DATABASE_URL:jdbc:h2:mem:testdb}}
spring.datasource.username=${DB_USERNAME:sa}
spring.datasource.password=${DB_PASSWORD:}
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true

# Fix for "Table not found": Run data.sql AFTER Hibernate creates tables
spring.jpa.defer-datasource-initialization=true

# Crucial for Render: If data already exists, ignore errors and continue starting
spring.sql.init.continue-on-error=true

# Actuator configuration for health checks
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=always

# Optimize for cloud deployment
spring.jpa.properties.hibernate.jdbc.batch_size=25
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.jdbc.batch_versioned_data=true

# Connection pool settings for cloud
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=20000
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=1200000